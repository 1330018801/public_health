<div class="row" style="padding-top: 30px">
    <div class="col-md-6" align="right">
        <div class="form-group" >
            <label for="town_clinic">乡镇卫生院:</label>
        </div>
    </div>
    {% if user.userprofile.role.name == "卫生院管理员" %}
    <div class="col-md-6" align="left">
        <div class="form-group">
             {{ town_clinic.name }}<input type="text" style="display:none;" name="town_clinic" value="{{ town_clinic.id }}">
        </div>
    </div>
    {% else %}
    <div class="col-md-6" align="left">
        <div class="form-group">
            <select class="form-control" id="town_clinic" name="town_clinic">
                <option value="0">请选择</option>
                {% for town_clinic in town_clinics %}
                    <option value="{{ town_clinic.id }}">{{ town_clinic.name }}</option>
                {% endfor %}
            </select>
        </div>
    </div>
    {% endif %}
</div><!-- row -->
<div class="row" style="padding-top: 30px">
    <div class="col-md-6" align="right">
        <div class="form-group">
            <label for="village_clinic">村卫生室:</label>
        </div>
    </div>
    {% if user.userprofile.role.name == "卫生院管理员"%}
    <div class="col-md-6" align="left">
        <div class="form-group">
            <select class="form-control" id="village_clinic" name="village_clinic">
                <option value="0">请选择</option>
                {% for village_clinic in village_clinics %}
                    <option value="{{ village_clinic.id }}">{{ village_clinic.name }}</option>
                {% endfor %}
            </select>
        </div>
    </div>
    {% else %}
    <div class="col-md-6" align="left">
        <div class="form-group">
            <select class="form-control" id="village_clinic" name="village_clinic">
                <option value="0">请选择</option>
            </select>
        </div>
    </div>
    <script>
    $(document).ready(function() {
        $("select#town_clinic").change(function() {
            if ($(this).val() == '0'){
                $("select#village_clinic").html("<option>请选择</option>");
                $("select#village_clinic").attr('disabled', true);
            }
            else {
                var url = "/management/clinic/" + $(this).val() + "/village_clinics/";
                $.getJSON(url, function(village_clinics) {
                    var options = '<option value="0">请选择</option>';
                    for (var i = 0; i < village_clinics.length; i++) {
                        options += '<option value="' + village_clinics[i].pk + '">' + village_clinics[i].fields['name'] + '</option>';
                    }
                    $("select#village_clinic").html(options);
                    $("select#village_clinic option:first").attr('selected', 'selected');
                    $("select#village_clinic").attr('disabled', false);
                });
            }
        });
    })
    </script>
    {% endif %}
</div><!-- for row -->

